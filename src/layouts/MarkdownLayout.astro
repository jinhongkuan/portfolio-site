---
import BaseLayout from './BaseLayout.astro';
import SidebarLayout from './SidebarLayout.astro';

const { frontmatter } = Astro.props;
const title = frontmatter.title || 'Jin Kuan';
const { relatedNotes = [], relatedThreads = [] } = frontmatter;

// Use SidebarLayout if there are related items, otherwise use BaseLayout
const hasRelated = relatedNotes.length > 0 || relatedThreads.length > 0;
const Layout = hasRelated ? SidebarLayout : BaseLayout;
---

<Layout title={title} relatedNotes={relatedNotes} relatedThreads={relatedThreads}>
  <article class="markdown-content">
    <slot />
  </article>
</Layout>

<style>
  .markdown-content {
    max-width: 800px;
    margin: 0 auto;
  }
  
  /* First H1 gets special treatment */
  .markdown-content :global(h1:first-of-type) {
    font-size: 2.5rem;
    line-height: 1.2;
    margin-bottom: 4rem;
  }
  
  .markdown-content :global(strong) {
    font-weight: 500;
  }

  .markdown-content :global(em) {
    font-style: italic;
  }

  /* Evidence sections */
  .markdown-content :global(p > strong:first-child) {
    display: block;
    font-family: var(--font-sans);
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: 2rem;
    margin-bottom: 0.5rem;
  }

  /* Horizontal rules */
  .markdown-content :global(hr) {
    margin: 3rem 0 1.5rem;
  }

  /* Footer notes */
  .markdown-content :global(hr + p) {
    font-family: var(--font-sans);
    font-size: 0.85rem;
    font-style: italic;
    opacity: 0.7;
  }
</style>