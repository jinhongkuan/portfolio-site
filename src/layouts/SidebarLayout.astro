---
import BaseLayout from './BaseLayout.astro';
import RelatedContent from '../components/content/RelatedContent.astro';

export interface Props {
  title?: string;
  description?: string;
  relatedNotes?: Array<{title: string, url: string}>;
  relatedThreads?: Array<{title: string, url: string}>;
}

const { title, description, relatedNotes = [], relatedThreads = [] } = Astro.props;
const hasRelated = relatedNotes.length > 0 || relatedThreads.length > 0;
---

<BaseLayout title={title} description={description}>
  <div class={hasRelated ? "sidebar-layout" : "single-column"}>
    {hasRelated && (
      <aside class="sidebar">
        <RelatedContent notes={relatedNotes} threads={relatedThreads} />
      </aside>
    )}
    <article class="main-content">
      <slot />
    </article>
  </div>
</BaseLayout>

<style>
  .sidebar-layout {
    display: grid;
    grid-template-columns: 250px 1fr;
    gap: 4rem;
    align-items: start;
    position: relative;
  }

  .single-column {
    max-width: var(--max-width-narrow);
    margin: 0 auto;
  }

  .sidebar {
    position: sticky;
    top: 2rem;
    max-height: calc(100vh - 4rem);
    overflow-y: auto;
  }

  .main-content {
    max-width: var(--max-width-narrow);
  }

  /* Hide sidebar on mobile */
  @media (max-width: 1024px) {
    .sidebar-layout {
      display: block;
    }

    .sidebar {
      display: none;
    }

    .main-content {
      max-width: 100%;
    }
  }
</style>